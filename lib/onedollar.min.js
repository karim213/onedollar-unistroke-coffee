var OneDollar;OneDollar=function(){function t(t){return null==t&&(t={}),x=t,"score"in x||(x.score=80),"parts"in x||(x.parts=64),"angle"in x||(x.angle=45),n=s(x.angle),"step"in x||(x.step=2),i=s(x.step),"size"in x||(x.size=250),o=x.size,e=.5*Math.sqrt(o*o+o*o),this}var n,e,r,o,i,u,a,f,h,s,p,l,c,d,g,v,y,M,m,b,O,w,x,z,j;return r=.5*(-1+Math.sqrt(5)),o=e=n=i=null,x={},z={},m={},w=!1,b=[],t.prototype.add=function(t,n){return n.length>0&&(z[t]=j(n)),this},t.prototype.remove=function(t){return void 0!==z[t]&&delete z[t],this},t.prototype.on=function(t,n){var e,r,o,i;if(o=[],"*"===t)for(t in z)i=z[t],o.push(t);else o=t.split(" ");for(e=0,r=o.length;e<r;e++){if(t=o[e],void 0===z[t])throw new Error("The template '"+t+"' isn't defined.");m[t]=n,w=!0}return this},t.prototype.off=function(t){var n;if(void 0!==m[t]){delete m[t],w=!1;for(t in m)if(n=m[t],z.hasOwnProperty(t)){w=!0;break}}return this},t.prototype.toObject=function(){return{options:x,templates:z,binds:m}},t.prototype.start=function(t,n){return"object"==typeof t&&"undefined"==typeof n&&(n=t,t=-1),b[t]=[],this.update(t,n),this},t.prototype.update=function(t,n){return"object"==typeof t&&"undefined"==typeof n&&(n=t,t=-1),b[t].push(n),this},t.prototype.end=function(t,n){var e;return"object"==typeof t&&"undefined"==typeof n&&(n=t,t=-1),this.update(t,n),e=this.check(b[t]),delete b[t],e},t.prototype.check=function(t){var n,r,o,i,a,f,h,s,p,l,c;if(n=!1,s=t.length,s<3)return n;h={start:[t[0][0],t[0][1]],end:[t[s-1][0],t[s-1][1]],centroid:s>1?u(t):h.start},t=j(t),p=[],r=+(1/0),o=null;for(f in z)c=z[f],w!==!1&&void 0===m[f]||(i=O(t,c),l=parseFloat((100*(1-i/e)).toFixed(2)),isNaN(l)&&(l=0),p.push({name:f,score:l}),i<r&&(r=i,o=f));return p.length>0&&(p.length>1&&p.sort(function(t,n){return t.score<n.score?1:-1}),a=t.length-1,n={name:p[0].name,score:p[0].score,recognized:!1,path:h,ranking:p},p[0].score>=x.score&&(n.recognized=!0,w&&m[p[0].name].apply(this,[n]))),n},j=function(t){return t=g(t),t=v(t),t=y(t),t=M(t)},O=function(t,e){var o,a,f,h,s,p,l;for(s=n,h=-n,o=u(t),p=r*h+(1-r)*s,a=d(t,e,p,o),l=(1-r)*h+r*s,f=d(t,e,l,o);Math.abs(s-h)>i;)a<f?(s=l,l=p,f=a,p=r*h+(1-r)*s,a=d(t,e,p,o)):(h=p,p=l,a=f,l=(1-r)*h+r*s,f=d(t,e,l,o));return Math.min(a,f)},g=function(t){var n,e,r,o,i,u,a,s,p;for(u=h(t)/(x.parts-1),n=0,i=[],i.push([t[0][0],t[0][1]]),e=1;e<t.length;)o=t[e-1],r=t[e],a=f(o,r),n+a>=u?(s=o[0]+(u-n)/a*(r[0]-o[0]),p=o[1]+(u-n)/a*(r[1]-o[1]),i.push([s,p]),t.splice(e,0,[s,p]),n=0):n+=a,e+=1;for(;i.length<x.parts;)i.push([t[t.length-1][0],t[t.length-1][1]]);return i},v=function(t){var n,e;return n=u(t),e=Math.atan2(n[1]-t[0][1],n[0]-t[0][0]),p(t,-e,n)},y=function(t){var n,e,r,i,u,a,f,h,s,p;for(f=h=+(1/0),u=a=-(1/0),r=0,i=t.length;r<i;r++)p=t[r],f=Math.min(p[0],f),u=Math.max(p[0],u),h=Math.min(p[1],h),a=Math.max(p[1],a);return n=u-f,e=a-h,s=[o/n,o/e],l(t,s)},M=function(t){var n;return n=u(t),n[0]*=-1,n[1]*=-1,c(t,n)},d=function(t,n,e,r){var o,i;return o=p(t,e,r),i=a(o,n)},a=function(t,n){var e,r,o,i,u;for(e=0,o=r=0,i=t.length;r<i;o=++r)u=t[o],e+=f(t[o],n[o]);return e/t.length},h=function(t){var n,e,r,o,i;for(r=0,i=null,n=0,e=t.length;n<e;n++)o=t[n],null!==i&&(r+=f(i,o)),i=o;return r},f=function(t,n){var e,r;return e=Math.pow(t[0]-n[0],2),r=Math.pow(t[1]-n[1],2),Math.sqrt(e+r)},u=function(t){var n,e,r,o,i;for(o=0,i=0,n=0,e=t.length;n<e;n++)r=t[n],o+=r[0],i+=r[1];return o/=t.length,i/=t.length,[o,i]},p=function(t,n,e){var r,o,i,u,a,f,h,s,p;for(p=Math.sin(n),r=Math.cos(n),h=[],a=u=0,f=t.length;u<f;a=++u)s=t[a],o=t[a][0]-e[0],i=t[a][1]-e[1],t[a][0]=o*r-i*p+e[0],t[a][1]=o*p+i*r+e[1];return t},l=function(t,n){var e,r,o,i;for(r=e=0,o=t.length;e<o;r=++e)i=t[r],t[r][0]*=n[0],t[r][1]*=n[1];return t},c=function(t,n){var e,r,o,i;for(r=e=0,o=t.length;e<o;r=++e)i=t[r],t[r][0]+=n[0],t[r][1]+=n[1];return t},s=function(t){return t*Math.PI/180},t}(),"undefined"!=typeof exports&&(exports.OneDollar=OneDollar);